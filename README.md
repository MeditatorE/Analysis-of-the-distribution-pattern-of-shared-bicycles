# Analysis-of-the-distribution-pattern-of-shared-bicycles
This is the final project for ECE143. The goal of this project is to analyze the existing (Washington, DC) bikeshare distribution patterns, identify characteristics associated with the distribution patterns, and attempt to predict optimal future deployment strategies.

## 0. Quick Start
1. Clone this repo
```
git clone https://github.com/MeditatorE/Analysis-of-the-distribution-pattern-of-shared-bicycles.git
cd Analysis-of-the-distribution-pattern-of-shared-bicycles-main
```
2. Install dependency packages
```
pip install -r requirements.txt
```

3. Please download the corresponding data on **[Kaggle](https://www.kaggle.com/datasets/taweilo/capital-bikeshare-dataset-202005202408/data)** and put the data in the [sources folder](https://github.com/MeditatorE/Analysis-of-the-distribution-pattern-of-shared-bicycles/tree/main/sources).

4. Run the [data_analysis.py](https://github.com/MeditatorE/Analysis-of-the-distribution-pattern-of-shared-bicycles/blob/main/data_analysis.py) file, which will generate all the .csv files used for visualization and model training
```
python data_analysis.py
```

6. Download **[Jupyter notebook](https://jupyter.org)** and run
```
jupyter notebook
```

7. Run the [Visualization and Prediction Models.ipynb](https://github.com/MeditatorE/Analysis-of-the-distribution-pattern-of-shared-bicycles/blob/main/Visualization%20and%20Prediction%20Models.ipynb) file, which will visualize the analysis results and train a model that can be used to predict future bike rental volume.

## 1. File Description
**[data_analysis.py](https://github.com/MeditatorE/Analysis-of-the-distribution-pattern-of-shared-bicycles/blob/main/data_analysis.py)**: This file integrates all the modules for data analysis. It will generate all the .csv files for model training and data visualization.

**[Visualization and Prediction Models.ipynb](https://github.com/MeditatorE/Analysis-of-the-distribution-pattern-of-shared-bicycles/blob/main/Visualization%20and%20Prediction%20Models.ipynb)**: This file integrates all the codes for data visualization and model training. Please run [data_analysis.py](https://github.com/MeditatorE/Analysis-of-the-distribution-pattern-of-shared-bicycles/blob/main/data_analysis.py) before running this file.

**[data_analysis.ipynb](https://github.com/MeditatorE/Analysis-of-the-distribution-pattern-of-shared-bicycles/blob/main/data_analysis.ipynb)**: This file is the original file used for data analysis. It integrates all the codes in this project, including the abandoned parts. It also contains some conclusions of this analysis. If you are interested, you can take a look at it.

**[Member_new.ipynb](https://github.com/MeditatorE/Analysis-of-the-distribution-pattern-of-shared-bicycles/blob/main/Member_new.ipynb)**: This file is a supplementary file for membership analysis, and its content has been integrated into [Visualization and Prediction Models.ipynb](https://github.com/MeditatorE/Analysis-of-the-distribution-pattern-of-shared-bicycles/blob/main/Visualization%20and%20Prediction%20Models.ipynb).

**[sources](https://github.com/MeditatorE/Analysis-of-the-distribution-pattern-of-shared-bicycles/tree/main/sources)**: This folder is used to store the original data. You should download the original data on **[Kaggle](https://www.kaggle.com/datasets/taweilo/capital-bikeshare-dataset-202005202408/data)** and put it in this folder.

**[csv file](https://github.com/MeditatorE/Analysis-of-the-distribution-pattern-of-shared-bicycles/tree/main/csv%20file)**: This folder stores almost all (except those with huge amounts of data) csv files generated by [data_analysis.py](https://github.com/MeditatorE/Analysis-of-the-distribution-pattern-of-shared-bicycles/blob/main/data_analysis.py).

**[html](https://github.com/MeditatorE/Analysis-of-the-distribution-pattern-of-shared-bicycles/tree/main/html)**: This folder stores interactive visualization station data (marked on the map). They are in HTML format. You need to download the HTML file and open it with a browser.

**[result_picture](https://github.com/MeditatorE/Analysis-of-the-distribution-pattern-of-shared-bicycles/tree/main/result_picture)**: This file stores the visualization results of all data analysis. All files are in png image format.

**All the dependent modules of this project are as follows:**
```
branca==0.8.0
folium==0.18.0
matplotlib==3.6.2
numpy==1.23.5
pandas==1.5.3
prophet==1.1.6
scikit_learn==1.3.2
scipy==1.9.1
seaborn==0.13.2
tqdm==4.64.1
xgboost==2.1.3
```

**The specific structure of all files is as follows:**
```
/main/
├── Member_new.ipynb
├── Visualization and Prediction Models.ipynb
├── csv file
│   ├── Difference.csv
│   ├── df_date_Clear.csv
│   ├── df_date_Cloudy.csv
│   ├── df_date_Partially_cloudy.csv
│   ├── df_date_Rain.csv
│   ├── df_date_Snow.csv
│   ├── df_date_Wind.csv
│   ├── df_date_rent_num.csv
│   ├── df_date_weather_num.csv
│   ├── df_member_casual.csv
│   ├── df_member_start.csv
│   ├── df_month_time.csv
│   ├── df_pro.csv
│   ├── df_station_time.csv
│   ├── start_percentage.csv
│   └── stats_with_type.csv
├── data_analysis.ipynb
├── data_analysis.py
├── html
│   ├── my_map_end.html
│   ├── my_map_start.html
│   ├── washington_map_in_out.html
│   ├── washington_map_member.html
│   └── washington_map_type.html
├── result_picture
│   ├── Actual vs Predicted Rental Counts.png
│   ├── Difference.png
│   ├── Feature Importance XGBoost.png
│   ├── Percentage of rentals.png
│   ├── Prophet_result.png
│   ├── Ride_duration.png
│   ├── Station_Type_rent.png
│   ├── full Difference.png
│   ├── full Percentage of rentals.png
│   ├── heatmap_rental_quantities.png
│   ├── heatmap_station_time.png
│   ├── member_barchart.png
│   ├── member_station.png
│   ├── new_heatmap_station_time.png
│   ├── total.png
│   ├── total_gaussian.png
│   ├── weather_avg.png
│   └── weather_rent_num.png
└── sources
    ├── daily_rent_detail.csv
    ├── station_list.csv
    ├── stations.csv
    ├── usage_frequency.csv
    └── weather.csv
```

## 2. Dataset Overview
The data volume of this project exceeds 10 million, about 16,000,000 data. We downloaded this data from **[Kaggle](https://www.kaggle.com/datasets/taweilo/capital-bikeshare-dataset-202005202408/data)**, including:

1. File information: 4 files /duration 2020/05~2024/08

- Daily rent data

ride_id: ride id

rideable_type: ride type. I.e. docked_bike, electric_bike, classic_bike

started_at: start date and time

ended_at: end date and time

start_station_name: starting station name

start_station_id: starting station id

end_station_name: ending station name

end_station_id: ending station id

start_lat: start latitude

start_lng: start longitude

end_lat: end latitude

end_lng: end longitude

member_casual: Indicates whether user was a "registered" member (Annual Member, 30-Day Member or Day Key Member) or a "casual" rider (Single Trip, 24-Hour Pass, 3-Day Pass or 5-Day Pass). I.e. casual, member

Data source: [https://capitalbikeshare.com/system-data](https://capitalbikeshare.com/system-data)

- Station list

station_id: station id

station_name: station name

Data source: organized from Daily rent data

- Usage frequency

date: date

station_name: station name

pickup_counts: daily pickup of the station

dropoff_counts: daily dropoff of the station

Data source: organized from Daily rent data

- Weather

name: location

datetime: date

tempmax: maximum temperature at the location.

tempmin: minimum temperature at the location.

temp: temperature at the location. Daily values are average values (mean) for the day.

feelslikemax: maximum feels like temperature at the location.

feelslikemin: minimum feels like temperature at the location.

feelslike: what the temperature feels like accounting for heat index or wind chill. Daily values are average values (mean) for the day.

dew: dew point temperature

humidity: relative humidity in %

precip: the amount of liquid precipitation that fell or is predicted to fall in the period.

precipprob: the likelihood of measurable precipitation ranging from 0% to 100%

precipcover: the proportion of hours where there was non-zero precipitation

preciptype: an array indicating the type(s) of precipitation expected or that occurred.

snow: the amount of snow that fell or is predicted to fall

snowdepth: the depth of snow on the ground

windgust: instantaneous wind speed at a location

windspeed: the sustained wind speed measured as the average windspeed that occurs during the preceding one to two minutes. Daily values are the maximum hourly value for the day.

winddir: direction from which the wind is blowing

sealevelpressure: the sea level atmospheric or barometric pressure in millibars

cloudcover: the sea level atmospheric or barometric pressure in millibars

visibility: distance at which distant objects are visible

solarradiation: (W/m2) the solar radiation power at the instantaneous moment of the observation (or forecast prediction)

solarenergy: (MJ /m2 ) indicates the total energy from the sun that builds up over a day.

uvindex: a value between 0 and 10 indicating the level of ultra violet (UV) exposure for that day.

severerisk: a value between 0 and 100 representing the risk of convective storms

sunrise: the formatted time of the sunrise

sunset: the formatted time of the sunset

moonphase: represents the fractional portion through the current moon lunation cycle ranging from 0 (the new moon) to 0.5 (the full moon) and back to 1 (the next new moon)

conditions: textual representation of the weather conditions.

description: longer text descriptions suitable for displaying in weather displays

icon: a fixed, machine readable summary that can be used to display an icon

stations: the weather stations used when collecting a historical observation record

Parameters information: [https://www.visualcrossing.com/resources/documentation/weather-api/timeline-weather-api/](https://www.visualcrossing.com/resources/documentation/weather-api/timeline-weather-api/)

Data source : [https://www.visualcrossing.com/](https://www.visualcrossing.com/)

## 3. Data analysis
### 3.1 Analysis of rental quantity
We analyzed the total rental data over the past four years and found that the data has seasonal cyclical changes and has been increasing over the past four years, so we Gaussian smoothed the data to calculate the growth rate:
![](https://github.com/MeditatorE/Face-time-travel-machine/blob/main/Demo/QQ20210918-220741-HD.gif)
![](https://github.com/MeditatorE/Face-time-travel-machine/blob/main/Demo/QQ20210918-220741-HD.gif)
Finally, we found that the **annual growth rate was 12.5%**, which means that our first distribution strategy is that the total number of bicycles put into use should increase by 12.5% ​​each year.


